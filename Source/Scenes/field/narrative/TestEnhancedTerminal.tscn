[gd_scene load_steps=2 format=3 uid="uid://test_enhanced_terminal_scene"]

[ext_resource type="Script" uid="uid://test_enhanced_terminal_script" path="res://Source/Scripts/field/narrative/TestEnhancedTerminal.cs" id="1_script"]

[node name="TestEnhancedTerminal" type="Node2D"]
script = ExtResource("1_script")

[node name="TerminalUI" type="Control" parent="."]
position = Vector2(0, 0)
size = Vector2(800, 600)
anchor_right = 1.0
anchor_bottom = 1.0
TypewriterSpeed = 0.025
DissolveDuration = 0.75
GlowPulseSpeed = 2.0
GlowIntensity = 0.5
EnableGhostWriting = true
EnableDissolveEffects = true
EnableScrambleEffects = true
EnableTypewriterAudio = true
EnableGlowEffects = true
EnableDepthPerception = true

[node name="Terminal" type="Terminal" parent="TerminalUI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
size_flags_vertical = 4
focus_mode = 1

[node name="PTY" type="PTY" parent="TerminalUI"]
cols = 80
rows = 25
terminal_path = NodePath("../Terminal")

[node name="EnhancedTerminalDisplay3D" type="Node3D" parent="TerminalUI"]
position = Vector3(400, 300, 0)

[node name="EnhancedTerminalDisplayBox" type="Node3D" parent="TerminalUI/EnhancedTerminalDisplay3D"]
position = Vector3(0, 0, 2.5)
rotation = Vector3(-0.05, 0, 0)
scale = Vector3(0.95, 0.95, 1)

[node name="ScreenMesh" type="MeshInstance3D" parent="TerminalUI/EnhancedTerminalDisplay3D/EnhancedTerminalDisplayBox"]
mesh = SubResource("1_mesh")
position = Vector3(0, 0, 0.1)
material_override = SubResource("1_material")

[node name="Camera3D" type="Camera3D" parent="TerminalUI/EnhancedTerminalDisplay3D"]
position = Vector3(0, 0, 12)
fov = 25.0

[node name="ScreenLight" type="DirectionalLight3D" parent="TerminalUI/EnhancedTerminalDisplay3D"]
position = Vector3(0, -1, -2)
rotation = Vector3(0.942, 0, 0)
light_color = Color(0.2, 1, 0.2, 1)
light_energy = 0.3
light_indirect_energy = 0.5

[node name="EnhancedOverlayCanvas" type="CanvasLayer" parent="TerminalUI"]
scale = Vector2(1, 1)

[node name="EnhancedOverlayText" type="RichTextLabel" parent="TerminalUI/EnhancedOverlayCanvas"]
name = "EnhancedOverlayText"
size = Vector2(750, 400)
position = Vector2(25, 25)
bbcode_enabled = true
autowrap_mode = 3
scroll_active = false
theme = SubResource("1_theme")

[node name="EnhancedScreenGlow" type="TextureRect" parent="TerminalUI"]
name = "EnhancedScreenGlow"
size = Vector2(800, 450)
position = Vector2(0, 75)
modulate = Color(0.2, 1, 0.2, 0.1)
stretch_mode = 3
visible = true

[node name="EnhancedTypewriterTimer" type="Timer" parent="TerminalUI"]
name = "EnhancedTypewriterTimer"

[node name="EnhancedDissolveTimer" type="Timer" parent="TerminalUI"]
name = "EnhancedDissolveTimer"

[node name="EnhancedScrambleTimer" type="Timer" parent="TerminalUI"]
name = "EnhancedScrambleTimer"

[node name="EnhancedGlowPulseTimer" type="Timer" parent="TerminalUI"]
name = "EnhancedGlowPulseTimer"

[node name="EnhancedTypewriterAudio" type="AudioStreamPlayer" parent="TerminalUI"]
name = "EnhancedTypewriterAudio"
bus = "SFX"
volume_db = -10.0

[sub_resource type="PlaneMesh" id="1_mesh"]
size = Vector2(8, 4.5)
subdivide_depth = 8
subdivide_width = 8

[sub_resource type="StandardMaterial3D" id="1_material"]
albedo_color = Color(0.02, 0.05, 0.02, 1)
emission_enabled = true
emission = Color(0.2, 1, 0.2)
emission_energy_multiplier = 0.5
metallic = 0.9
roughness = 0.1
specular = 0.95
cull_mode = 2

[sub_resource type="Theme" id="1_theme"]
data/font_sizes/normal_font_size/Label = 16
data/font_sizes/normal_font_size/RichTextLabel = 16
data/colors/default_color/RichTextLabel = Color(0.2, 1, 0.2, 0.95)
data/colors/font_shadow_color/RichTextLabel = Color(0, 0.1, 0, 1)
data/constants/shadow_offset_x/RichTextLabel = 1
data/constants/shadow_offset_y/RichTextLabel = 1
data/constants/outline_size/RichTextLabel = 1
data/colors/outline_color/RichTextLabel = Color(0, 0.3, 0, 0.5)

[connection signal="data_sent" from="TerminalUI/Terminal" to="TerminalUI/PTY" method="write"]
[connection signal="size_changed" from="TerminalUI/Terminal" to="TerminalUI/PTY" method="resizev"]
[connection signal="data_received" from="TerminalUI/PTY" to="TerminalUI/Terminal" method="write"]
[connection signal="exited" from="TerminalUI/PTY" to="TerminalUI/Terminal" method="_on_PTY_exited"]
