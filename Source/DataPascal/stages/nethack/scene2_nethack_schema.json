{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://omega-spiral.dev/contracts/scene2_nethack_schema.json",
  "title": "ASCII Dungeon Sequence Schema",
  "description": "JSON schema for NetHack-style ASCII dungeon exploration data",
  "type": "object",
  "properties": {
    "type": { "type": "string", "enum": [ "ascii_dungeon_sequence" ], "description": "Scene type identifier" },
    "dungeons": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "owner": { "type": "string", "enum": [ "light", "mischief", "wrath" ], "description": "Dreamweaver that owns this dungeon" },
          "map": {
            "type": "array",
            "items": { "type": "string", "pattern": "^[#.@DMC~\\s]{10,30}$", "description": "ASCII map row (walls, floors, objects)" },
            "minItems": 5,
            "maxItems": 20,
            "description": "2D ASCII grid representing dungeon layout"
          },
          "legend": {
            "type": "object",
            "patternProperties": { "^.$": { "type": "string", "minLength": 1, "maxLength": 20 } },
            "propertyNames": { "pattern": "^.$" },
            "description": "Mapping of ASCII characters to descriptions"
          },
          "objects": {
            "type": "object",
            "patternProperties": {
              "^[DMC]$": {
                "type": "object",
                "properties": {
                  "type": { "type": "string", "enum": [ "door", "monster", "chest" ], "description": "Type of interactive object" },
                  "text": { "type": "string", "minLength": 10, "maxLength": 300, "description": "Narrative text when interacting with object" },
                  "aligned_to": { "type": "string", "enum": [ "light", "mischief", "wrath" ], "description": "Dreamweaver this object is aligned with" }
                },
                "required": [ "type", "text", "aligned_to" ]
              }
            },
            "propertyNames": { "pattern": "^[DMC]$" },
            "description": "Interactive objects positioned in the dungeon"
          }
        },
        "required": [ "owner", "map", "legend", "objects" ]
      },
      "minItems": 3,
      "maxItems": 3,
      "description": "Three sequential dungeons owned by different Dreamweavers"
    }
  },
  "required": [
    "type",
    "dungeons"
  ]
}
